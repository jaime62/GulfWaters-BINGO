<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CSV to HTML Generator</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
    }
    textarea {
      width: 100%;
      height: 200px;
      margin-bottom: 1rem;
    }
    pre {
      background: #f4f4f4;
      padding: 1rem;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    button {
      margin-right: 1rem;
    }
  </style>
</head>
<body>
  <h2>CSV to HTML Generator</h2>
  <textarea id="csvInput" placeholder="Paste CSV data here..."></textarea>
  <br />
  <button onclick="convertCSV()">Generate HTML</button>
  <button onclick="clearOutput()">Clear</button>
  <pre id="htmlOutput"></pre>

  <script>
    const emojiMap = {
      "Apparel & Protection": "üëï",
      "Boating Accessories": "‚õµÔ∏è",
      "Electronics": "üì±",
      "Rods & Reels": "üé£",
      "Storage": "üìÇ",
      "Tackle": "üîç",
      "Tools": "üîß"
    };

    function convertCSV() {
      const input = document.getElementById("csvInput").value.trim();
      const lines = input.split("\n");

      const data = lines.slice(1).map(line => line.split(",").map(cell => cell.replace(/^"|"$/g, "").trim()));
      const categories = {};

      for (const [cat, sub, subsub, liHTML] of data) {
        if (!cat || !sub || !liHTML) continue;
        if (!categories[cat]) categories[cat] = {};
        if (!categories[cat][sub]) categories[cat][sub] = [];
        categories[cat][sub].push(liHTML);
      }

      let html = "";

      for (const [cat, subcats] of Object.entries(categories)) {
        const emoji = emojiMap[cat] || "üêü"; // fallback fish emoji
        html += `<div class="category" onclick="toggle(this)"><span class="emoji">${emoji}</span> ${cat}</div>\n`;
        html += `<div class="subcategory">\n`;

        for (const [sub, items] of Object.entries(subcats)) {
          html += `  <div class="sub-subcategory">\n`;
          html += `    <h4>${sub}</h4>\n`;
          html += `    <ul>\n`;
          for (const item of items) {
            html += `      ${item}\n`;
          }
          html += `    </ul>\n`;
          html += `  </div>\n`;
        }

        html += `</div>\n`;
      }

      document.getElementById("htmlOutput").textContent = html;
    }

    function clearOutput() {
      document.getElementById("csvInput").value = '';
      document.getElementById("htmlOutput").textContent = '';
    }
  </script>
</body>
</html>
